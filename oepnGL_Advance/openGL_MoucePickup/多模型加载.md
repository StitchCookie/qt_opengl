## 多模型加载

首先创建结构体

```c++
struct ModelInfo
{
    Model  *mode;
    QVector3D worldPos;
    float pitch;
    float yaw;
    float roll;
    bool isSelected;
    QString name;
};
```

删除原有的单个model类的成员

添加映射model

```c++
 QMap<QString,ModelInfo> m_Models;
```

修改加载模型函数

```c++
void COpenGlWidget::loadModel(string path)
{
    static int i = 1;
    makeCurrent();
    Model  *m_model = new Model(QOpenGLContext::currentContext()->versionFunctions<QOpenGLFunctions_3_3_Core>()
                               ,path.c_str());
    m_Models["模型"+QString::number(i++)] = ModelInfo{m_model,QVector3D(0,0,0),0.0,0.0,0.0,false,"模型"};
    m_camera.Position = cameraPosInit(m_model->m_maxY,m_model->m_minY);
    doneCurrent();
}
```

修改绘制函数

```c++
        if(m_Models.size() <= 0) return;
        foreach (auto item,m_Models) {
            model.setToIdentity();
            model.translate(item.worldPos);
            model.rotate(item.pitch,QVector3D(1.0,0.0,0.0));
            model.rotate(item.yaw,QVector3D(0.0,1.0,0.0));
            model.rotate(item.roll,QVector3D(0.0,0.0,1.0));
            item.mode->Draw(shaderProgramObject);
           shaderProgramObject.setUniformValue("model",model);
        }
```

调整顶点:将地面y设置为0

```c++
float planeVertices[] = {
    // positions          // texture Coords (note we set these higher than 1 (together with GL_REPEAT as texture wrapping mode). this will cause the floor texture to repeat)
    25.0f, 0.0f,  25.0f,  1.0f, 0.0f,
    -25.0f, 0.0f,  25.0f,  0.0f, 0.0f,
    -25.0f, 0.0f, -25.0f,  0.0f, 1.0f,

    25.0f, 0.0f,  25.0f,  1.0f, 0.0f,
    -25.0f, 0.0f, -25.0f,  0.0f, 1.0f,
    25.0f, 0.0f, -25.0f,  1.0f, 1.0f
};
```

删除盒子模型,只保留地面